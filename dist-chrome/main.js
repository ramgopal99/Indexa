import{r as l,j as e,C as M,I as T,S as P,a as w,z as L,L as I,b as E,J as z,c as O,d as R,B as x,H as N,T as h,V as v,e as B,f as H}from"./assets/vendor-BEWLfdc9.js";import{s as S,t as p}from"./assets/browser-api-jePXBwok.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))d(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const u of n.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&d(u)}).observe(document,{childList:!0,subtree:!0});function c(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function d(r){if(r.ep)return;r.ep=!0;const n=c(r);fetch(r.href,n)}})();function W(o){return e.jsx(z,{attribute:"class",disableTransitionOnChange:!0,...o})}function C(){const{resolvedTheme:o,setTheme:s,forcedTheme:c}=L();return{colorMode:c||o,setColorMode:s,toggleColorMode:()=>{s(o==="dark"?"light":"dark")}}}function q(){const{colorMode:o}=C();return o==="dark"?e.jsx(I,{}):e.jsx(E,{})}l.forwardRef(function(s,c){const{toggleColorMode:d}=C();return e.jsx(M,{fallback:e.jsx(P,{boxSize:"9"}),children:e.jsx(T,{onClick:d,variant:"ghost","aria-label":"Toggle color mode",size:"sm",ref:c,...s,css:{_icon:{width:"5",height:"5"}},children:e.jsx(q,{})})})});l.forwardRef(function(s,c){return e.jsx(w,{color:"fg",display:"contents",className:"chakra-theme light",colorPalette:"gray",colorScheme:"light",ref:c,...s})});l.forwardRef(function(s,c){return e.jsx(w,{color:"fg",display:"contents",className:"chakra-theme dark",colorPalette:"gray",colorScheme:"dark",ref:c,...s})});function A(o){return e.jsx(O,{value:R,children:e.jsx(W,{...o})})}const U=["https://chat.openai.com","https://chatgpt.com","https://claude.ai"];function b(o){return o?U.some(s=>o.startsWith(s)):!1}function D(){const[o,s]=l.useState(""),[c,d]=l.useState(!1),[r,n]=l.useState(!1),u=l.useRef(null),m=l.useCallback(async t=>{try{S&&S.executeScript&&(await S.executeScript({target:{tabId:t},files:["content.js"]}),console.log("Content script injected successfully"))}catch(a){console.error("Error injecting content script:",a)}},[]),y=l.useCallback(async()=>{try{const[t]=await p.query({active:!0,currentWindow:!0});if(t.id&&t.url){const a=b(t.url);if(n(a),a)try{const i=await p.sendMessage(t.id,{action:"getSidebarState"});i&&d(i.visible)}catch(i){console.log("Content script not ready, attempting to inject...",i),await m(t.id);try{const f=await p.sendMessage(t.id,{action:"getSidebarState"});f&&d(f.visible)}catch(f){console.log("Still unable to communicate with content script:",f)}}}}catch(t){console.log("Error checking sidebar state:",t)}},[m]);l.useEffect(()=>{p.query({active:!0,currentWindow:!0},g=>{g[0]?.title&&s(g[0].title),g[0]?.url&&n(b(g[0].url))});const t=setTimeout(()=>{y()},0),a=()=>{const j=localStorage.getItem("side-indexer-theme")||"light";u.current&&(j==="dark"?u.current.classList.add("dark"):u.current.classList.remove("dark")),j==="dark"?document.body.classList.add("dark"):document.body.classList.remove("dark")};a();const i=g=>{g.key==="side-indexer-theme"&&a()},f=setInterval(()=>{a()},100);return window.addEventListener("storage",i),()=>{window.removeEventListener("storage",i),clearInterval(f),clearTimeout(t)}},[y]);const k=async()=>{try{const[t]=await p.query({active:!0,currentWindow:!0});if(!t.id||!t.url){console.error("No active tab found");return}if(!b(t.url)){console.log("Current page is not supported. Please navigate to ChatGPT or Claude.");return}try{const a=await p.sendMessage(t.id,{action:"toggleSidebar"});a&&d(a.visible)}catch(a){console.log("Content script not ready, injecting...",a),await m(t.id),await new Promise(i=>setTimeout(i,100));try{const i=await p.sendMessage(t.id,{action:"toggleSidebar"});i&&d(i.visible)}catch(i){console.error("Error toggling sidebar after injection:",i)}}}catch(t){console.error("Error toggling sidebar:",t)}};return e.jsxs(x,{ref:u,w:"280px",minH:"200px",maxH:"400px",className:"popup-container",style:{backgroundColor:"var(--popup-bg)",color:"var(--popup-text)",minHeight:"200px",maxHeight:"400px",width:"280px"},children:[e.jsxs(x,{className:"popup-header",color:"white",p:3,textAlign:"center",borderBottomRadius:"lg",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},children:[e.jsx(N,{size:"sm",mb:1,children:"Indexa"}),e.jsx(h,{fontSize:"xs",opacity:.9,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxW:"250px",children:o})]}),e.jsx(v,{gap:3,p:3,children:r?e.jsx(B,{colorPalette:c?"red":"green",w:"full",onClick:k,size:"sm",children:c?"Hide Sidebar":"Show Sidebar"}):e.jsxs(x,{textAlign:"center",p:2,children:[e.jsx(h,{fontSize:"sm",color:"gray.500",mb:2,children:"This extension works on:"}),e.jsxs(v,{gap:1,align:"stretch",children:[e.jsx(h,{fontSize:"xs",children:"• chatgpt.com"}),e.jsx(h,{fontSize:"xs",children:"• claude.ai"})]}),e.jsx(h,{fontSize:"xs",color:"gray.400",mt:2,children:"Please navigate to one of these pages to use Indexa."})]})})]})}function V(){return e.jsx(D,{})}H.createRoot(document.getElementById("root")).render(e.jsx(l.StrictMode,{children:e.jsx(A,{children:e.jsx(V,{})})}));
