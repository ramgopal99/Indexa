import{r as d,j as e,C as M,I as P,S as T,a as v,z as L,L as I,b as E,J as z,c as O,d as R,B as x,H as N,T as h,V as j,e as B,f as H}from"./assets/vendor-BEWLfdc9.js";import{s as S,t as p}from"./assets/browser-api-DkcCqAXO.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))c(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const u of i.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&c(u)}).observe(document,{childList:!0,subtree:!0});function a(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function c(r){if(r.ep)return;r.ep=!0;const i=a(r);fetch(r.href,i)}})();function W(o){return e.jsx(z,{attribute:"class",disableTransitionOnChange:!0,...o})}function C(){const{resolvedTheme:o,setTheme:s,forcedTheme:a}=L();return{colorMode:a||o,setColorMode:s,toggleColorMode:()=>{s(o==="dark"?"light":"dark")}}}function q(){const{colorMode:o}=C();return o==="dark"?e.jsx(I,{}):e.jsx(E,{})}d.forwardRef(function(s,a){const{toggleColorMode:c}=C();return e.jsx(M,{fallback:e.jsx(T,{boxSize:"9"}),children:e.jsx(P,{onClick:c,variant:"ghost","aria-label":"Toggle color mode",size:"sm",ref:a,...s,css:{_icon:{width:"5",height:"5"}},children:e.jsx(q,{})})})});d.forwardRef(function(s,a){return e.jsx(v,{color:"fg",display:"contents",className:"chakra-theme light",colorPalette:"gray",colorScheme:"light",ref:a,...s})});d.forwardRef(function(s,a){return e.jsx(v,{color:"fg",display:"contents",className:"chakra-theme dark",colorPalette:"gray",colorScheme:"dark",ref:a,...s})});function A(o){return e.jsx(O,{value:R,children:e.jsx(W,{...o})})}const U=["https://chat.openai.com","https://chatgpt.com","https://claude.ai"];function b(o){return o?U.some(s=>o.startsWith(s)):!1}function D(){const[o,s]=d.useState(""),[a,c]=d.useState(!1),[r,i]=d.useState(!1),u=d.useRef(null),m=d.useCallback(async t=>{try{S&&S.executeScript?(await S.executeScript({target:{tabId:t},files:["content.js"]}),console.log("Content script injected successfully"),await new Promise(n=>setTimeout(n,300))):console.error("Scripting API not available")}catch(n){throw console.error("Error injecting content script:",n),n}},[]),y=d.useCallback(async()=>{try{const[t]=await p.query({active:!0,currentWindow:!0});if(t.id&&t.url){const n=b(t.url);if(i(n),n)try{const l=await p.sendMessage(t.id,{action:"getSidebarState"});l&&c(l.visible)}catch(l){console.log("Content script not ready, attempting to inject...",l),await m(t.id);try{const g=await p.sendMessage(t.id,{action:"getSidebarState"});g&&c(g.visible)}catch(g){console.log("Still unable to communicate with content script:",g)}}}}catch(t){console.log("Error checking sidebar state:",t)}},[m]);d.useEffect(()=>{p.query({active:!0,currentWindow:!0},f=>{f[0]?.title&&s(f[0].title),f[0]?.url&&i(b(f[0].url))});const t=setTimeout(()=>{y()},0),n=()=>{const w=localStorage.getItem("side-indexer-theme")||"light";u.current&&(w==="dark"?u.current.classList.add("dark"):u.current.classList.remove("dark")),w==="dark"?document.body.classList.add("dark"):document.body.classList.remove("dark")};n();const l=f=>{f.key==="side-indexer-theme"&&n()},g=setInterval(()=>{n()},100);return window.addEventListener("storage",l),()=>{window.removeEventListener("storage",l),clearInterval(g),clearTimeout(t)}},[y]);const k=async()=>{try{const[t]=await p.query({active:!0,currentWindow:!0});if(!t.id||!t.url){console.error("No active tab found");return}if(!b(t.url)){console.log("Current page is not supported. Please navigate to ChatGPT or Claude.");return}try{const n=await p.sendMessage(t.id,{action:"toggleSidebar"});n&&c(n.visible)}catch(n){console.log("Content script not ready, injecting...",n);try{await m(t.id);const l=await p.sendMessage(t.id,{action:"toggleSidebar"});c(l?l.visible:!0)}catch(l){console.error("Error toggling sidebar after injection:",l);try{await p.sendMessage(t.id,{action:"showSidebar"}),c(!0)}catch(g){console.error("Final attempt to show sidebar failed:",g)}}}}catch(t){console.error("Error toggling sidebar:",t)}};return e.jsxs(x,{ref:u,w:"280px",minH:"200px",maxH:"400px",className:"popup-container",style:{backgroundColor:"var(--popup-bg)",color:"var(--popup-text)",minHeight:"200px",maxHeight:"400px",width:"280px"},children:[e.jsxs(x,{className:"popup-header",color:"white",p:3,textAlign:"center",borderBottomRadius:"lg",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},children:[e.jsx(N,{size:"sm",mb:1,children:"Indexa"}),e.jsx(h,{fontSize:"xs",opacity:.9,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxW:"250px",children:o})]}),e.jsx(j,{gap:3,p:3,children:r?e.jsx(B,{colorPalette:a?"red":"green",w:"full",onClick:k,size:"sm",children:a?"Hide Sidebar":"Show Sidebar"}):e.jsxs(x,{textAlign:"center",p:2,children:[e.jsx(h,{fontSize:"sm",color:"gray.500",mb:2,children:"This extension works on:"}),e.jsxs(j,{gap:1,align:"stretch",children:[e.jsx(h,{fontSize:"xs",children:"• chatgpt.com"}),e.jsx(h,{fontSize:"xs",children:"• claude.ai"})]}),e.jsx(h,{fontSize:"xs",color:"gray.400",mt:2,children:"Please navigate to one of these pages to use Indexa."})]})})]})}function F(){return e.jsx(D,{})}H.createRoot(document.getElementById("root")).render(e.jsx(d.StrictMode,{children:e.jsx(A,{children:e.jsx(F,{})})}));
